\chapter{ Technical Foundations}

In this section/part, the mathematical and technical formulation of the models used for wind speed forecasting: ARIMA (AutoRegressive Integrated Moving Average) and LSTM (Long Short-Term Memory) are presented. Each model is accompanied by its predictive mechanism and evaluation metrics such as RMSE, MAE, MAPE, and $R^2$ score.

\section{ARIMA Model Formulation}

ARIMA is a widely used linear model for univariate time series forecasting. The ARIMA($p$, $d$, $q$) model is a combination of:
\begin{itemize}
	\item Autoregressive (AR) model of order $p$
	\item Differencing of order $d$ to make the time series stationary
	\item Moving Average (MA) model of order $q$
\end{itemize}

The general ARIMA($p,d,q$) model is defined as:
\begin{equation}
	\phi(B)(1 - B)^d y_t = \theta(B) \epsilon_t
\end{equation}
where:
\begin{itemize}
	\item $B$ is the backshift operator, i.e., $B^k y_t = y_{t-k}$
	\item $\phi(B) = 1 - \phi_1 B - \ldots - \phi_p B^p$ is the AR polynomial
	\item $\theta(B) = 1 + \theta_1 B + \ldots + \theta_q B^q$ is the MA polynomial
	\item $\epsilon_t$ is a white noise error term
\end{itemize}

Once the model is fitted using maximum likelihood estimation (MLE), future wind speeds $\hat{y}_{t+h}$ are forecasted recursively:
\begin{equation}
	\hat{y}_{t+h} = \sum_{i=1}^{p} \phi_i \hat{y}_{t+h-i} + \sum_{j=1}^{q} \theta_j \hat{\epsilon}_{t+h-j}
\end{equation}

\section{LSTM Network Formulation}

LSTM is a type of recurrent neural network (RNN) suitable for capturing long-term dependencies in sequential data. The LSTM unit at time $t$ is defined by the following equations:
\begin{align}
	f_t &= \sigma(W_f x_t + U_f h_{t-1} + b_f) \\
	i_t &= \sigma(W_i x_t + U_i h_{t-1} + b_i) \\
	\tilde{C}_t &= \tanh(W_C x_t + U_C h_{t-1} + b_C) \\
	C_t &= f_t \odot C_{t-1} + i_t \odot \tilde{C}_t \\
	o_t &= \sigma(W_o x_t + U_o h_{t-1} + b_o) \\
	h_t &= o_t \odot \tanh(C_t)
\end{align}

The forecasted wind speed is given by:
\begin{equation}
	\hat{y}_{t+1} = W_y h_t + b_y
\end{equation}

\section{Forecasting Pipeline}

% Make sure to load the TikZ libraries in your preamble:
% \usetikzlibrary{positioning,calc}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}[
		node distance=1.3cm and 1.5cm,
		box/.style={rectangle, draw=blue!60, fill=blue!5, thick, minimum height=1.2cm, minimum width=4.2cm, align=center},
		arrow/.style={thick,->,>=Stealth}
		]
		\node[box] (data) {Raw CSV Input \\ (Wind Speed + Date)};
		\node[box, below=of data] (pre) {Preprocessing \& Cleaning};
		\node[box, below left=of pre] (arima) {ARIMA \\ Forecasting};
		\node[box, below right=of pre] (lstm) {LSTM \\ Forecasting};
		\node[box] (eval) at ($(arima)!0.5!(lstm)$) {Evaluation Metrics \\ RMSE, MAE, MAPE, $R^2$};
		
		\draw[arrow] (data) -- (pre);
		\draw[arrow] (pre) -- (arima);
		\draw[arrow] (pre) -- (lstm);
		\draw[arrow] (arima) -- (eval);
		\draw[arrow] (lstm) -- (eval);
	\end{tikzpicture}
	\caption{Model Forecasting Pipeline}
\end{figure}

\section{Evaluation Metrics}

Let $y_t$ be the actual wind speed at time $t$, and $\hat{y}_t$ be the predicted wind speed.

\subsection{Root Mean Square Error (RMSE)}

RMSE measures the square root of the average squared differences between predicted and actual values. It penalizes larger errors more heavily, providing insight into the modelâ€™s overall accuracy.

\begin{equation}
	\text{RMSE} = \sqrt{\frac{1}{n} \sum_{t=1}^n (y_t - \hat{y}_t)^2}
\end{equation}

\subsection{Mean Absolute Error (MAE)}

MAE is the average of the absolute differences between predicted and actual values, reflecting the average magnitude of errors in the predictions without considering their direction.

\begin{equation}
	\text{MAE} = \frac{1}{n} \sum_{t=1}^n |y_t - \hat{y}_t|
\end{equation}

\subsection{Mean Absolute Percentage Error (MAPE)}

MAPE expresses the average absolute error as a percentage of the actual values, useful for understanding error relative to the scale of data.

\begin{equation}
	\text{MAPE} = \frac{100}{n} \sum_{t=1}^n \left| \frac{y_t - \hat{y}_t}{y_t} \right|
\end{equation}

\subsection{Coefficient of Determination ($R^2$ Score)}

The $R^2$ score quantifies the proportion of the variance in the actual values that is explained by the model. A value closer to 1 indicates a better fit.

\begin{equation}
	R^2 = 1 - \frac{\sum_{t=1}^n (y_t - \hat{y}_t)^2}{\sum_{t=1}^n (y_t - \bar{y})^2}
\end{equation}
where $\bar{y}$ is the mean of the actual wind speeds.

\section{Deployment Error Margin}

Based on the observed metrics in our training pipeline (MAE $\approx$ 11.1, RMSE $\approx$ 17.3), we permit a model deployment tolerance of up to \textbf{18\% error}, consistent with established thresholds from wind speed forecasting.

\subsection{Handling Missing Data: Forward-Backward Interpolation}

In time series data, missing values can occur due to sensor errors or data transmission loss. To ensure the continuity and quality of the input data, forward-backward interpolation is applied to estimate missing values.

\textbf{Forward Interpolation:} The missing value at time $t$ is approximated using the last known previous value:

\begin{equation}
	\hat{y}_t^{(f)} = y_{t-1}
\end{equation}

where $\hat{y}_t^{(f)}$ is the forward-interpolated value at time $t$, and $y_{t-1}$ is the last observed value before $t$.

\textbf{Backward Interpolation:} The missing value at time $t$ is also approximated using the next known future value:

\begin{equation}
	\hat{y}_t^{(b)} = y_{t+1}
\end{equation}

where $\hat{y}_t^{(b)}$ is the backward-interpolated value at time $t$, and $y_{t+1}$ is the next observed value after $t$.

\textbf{Final Interpolated Value:} The final estimate is taken as the average of forward and backward interpolations, providing a balanced estimation:

\begin{equation}
	\hat{y}_t = \frac{\hat{y}_t^{(f)} + \hat{y}_t^{(b)}}{2} = \frac{y_{t-1} + y_{t+1}}{2}
\end{equation}

This approach assumes linearity between known points and is effective for small gaps in data, ensuring smoother input for forecasting models.
